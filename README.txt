# Data analysis for the project: "Perturbation or Function? Intrinsic brain dynamics in the Default Mode Network predict involuntary fluctuations of visual awareness"

## Data repository: dx.doi.org/10.5061/dryad.bf1b1\

The original neuroimaging data that were accessible to the public have already been preprocessed based on standard preprocessing pipeline. Details of the preprocessing pipeline can be found in the published article: https://www.sciencedirect.com/science/article/pii/S1053811917301520?via%3Dihub

The head movement files necessary for the following fMRI data analyses were located here: https://github.com/Aubrey-Lyu/BR-project/tree/master/data/rivalry\_fMRI\_head\_motion\_files

## Data analysis pipeline:

To replicate the results of the project, apart from carrying out the pipeline right from the beginning with the original data; the reader/reviewer can also partially test some of the results in the midway. The intermediate results that may be used as the input data for next steps have been stored in the path: https://github.com/Aubrey-Lyu/BR-project/tree/master/data/intermediate, as well as in the "Results" folder in each Analysis module, e.g. https://github.com/Aubrey-Lyu/BR-project/tree/master/Analysis-2_fMRI/results

## Required toolboxes:

1.  MNE: https://mne.tools/dev/install/index.html
2.  HMM-MAR-master: https://github.com/OHBA-analysis/HMM-MAR/
3.  granger\_cause\_1: https://uk.mathworks.com/matlabcentral/fileexchange/59390-granger\_cause\_1
4.  spm12: https://www.fil.ion.ucl.ac.uk/spm/software/spm12/

## Variable naming explained: 

1\. HMM_results
\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-
1.1 \*Condition\*_results2.mat 
\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-

BR=Binocular Rivalry
Rpl_smt=Replay smooth

In the \*Condition\*\_results2.mat file, there are the following variables: FO, cond\_sub, SR, sumlife, mean\_Y, mean\_g, mean\_intervals, mean\_lifetimes, which correspond to fractonal occupancy, subjects, switching rate, total state lifetime, behaviour covariates, gamma, the interval between the state "up" moments, and (segmented) state lifetime for every trial. A trial is one epoch before a motor response. Note that these variables are all averaged across 276 timepoints of the trial. (It was 276 instead of 260 becuase I used 0.1s after motor onset as padding)

\- about state lifetime:
\- total statelifetime = sum(segmented state lifetime)
\- it was segmented becuase states are up and down intermittently.
\- to recover the state lifecourse across time, you need to use the state onsets, lifetimes/intervals. I have only estimated them for the state 4 during the BR\_dominant condition. (variables: "BR\_dominant\_k4\_onsets/lifetimes/intervals")

\- about behaviour covariates:
\- mean\_Y has 10 columns, but you only need the first two columns: Lat\_before and Lat_after, corresponding to perception duration (latency) before and after the motor response.

\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-
1.2 run1.mat 
\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-

The hmm output generated by the toolbox.
Gamma is the state activity, concatenated across all subjs, sessions, trials.
There are 276-14 = 262 timepoints for each trial in the Gamma. "-14" because the there are 14 points around each time point used for calculating autocorrelation.
To know the info of trials, see the data.mat.

======================================================================================
2\. HMM\_meta\_output.mat

It has 4 variables: X, Y, T, Sub
\- T: indicates how many timepoints for each trial. length(T) = total number of trials
\- Sub: indicates from which subjects this trial is recorded
\- X: source signals for 8 ROIs, which are {'rHP', 'lHP', 'lIPL', 'rIPL', 'PCU','PCC', 'ACC', 'V1'} in order
\- Y: dependent variables (10), which are Lat\_before (1), Lat\_after (1), Rsp\_moments (2), CDT\_code (6).
\- Lat\_before & Lat\_after are the latency before and after a motor response
\- CDT\_code = CONDITION code: when the value in the corresponding column is 1, it means this trial is recorded from this condition. The corresponding conditions are {'BR\_dominant', 'BR\_mixed', 'Rpl\_smt\_dominant', 'Rpl\_smt\_mixed','Rpl\_ins\_dominant', 'Rpl\_ins_mixed'} in order.
